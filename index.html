<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TellAnything | The truth has no name</title>
  <meta name="description" content="TellAnything is where anonymous truth gets raw reactions. What would you say if no one knew it was you?" />
  <meta name="theme-color" content="#07090f" />
  <style>
    :root {
      --bg: #07090f;
      --bg-soft: #0f1423;
      --card: rgba(19, 25, 42, 0.78);
      --card-border: rgba(148, 171, 233, 0.15);
      --text: #eff3ff;
      --muted: #9aa7c9;
      --accent: #59c7ff;
      --hug: #f7ae45;
      --omg: #a97eff;
      --meh: #7d8698;
      --reply: #67b9ff;
      --ok: #69f5ba;
      --danger: #ff7d93;
      --radius: 18px;
      --shadow: 0 20px 40px rgba(4, 6, 13, 0.5);
    }

    * {
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    html,
    body {
      margin: 0;
      padding: 0;
      background: radial-gradient(circle at 12% 15%, #18203b 0%, transparent 35%),
        radial-gradient(circle at 75% 0%, #21142f 0%, transparent 42%),
        var(--bg);
      color: var(--text);
      font-family: "Trebuchet MS", "Segoe UI", sans-serif;
      min-height: 100%;
    }

    body {
      overflow-x: hidden;
    }

    .hero {
      position: fixed;
      inset: 0;
      height: 100vh;
      display: grid;
      place-items: center;
      text-align: center;
      z-index: 0;
      transition: opacity 0.35s ease;
      will-change: transform, opacity;
      overflow: hidden;
      background: linear-gradient(160deg, rgba(7, 11, 20, 0.92), rgba(6, 8, 15, 0.65));
    }

    .hero::before,
    .hero::after {
      content: "";
      position: absolute;
      width: 120vmax;
      height: 120vmax;
      border-radius: 40%;
      background: radial-gradient(circle at 20% 30%, rgba(70, 118, 255, 0.2), transparent 55%),
        radial-gradient(circle at 80% 80%, rgba(193, 91, 255, 0.18), transparent 58%),
        radial-gradient(circle at 40% 80%, rgba(255, 119, 76, 0.12), transparent 56%);
      filter: blur(28px);
      animation: drift 28s linear infinite alternate;
      pointer-events: none;
    }

    .hero::after {
      animation-duration: 36s;
      animation-direction: alternate-reverse;
      opacity: 0.75;
    }

    .particles {
      position: absolute;
      inset: 0;
      overflow: hidden;
      pointer-events: none;
    }

    .particles span {
      position: absolute;
      width: 3px;
      height: 3px;
      background: rgba(200, 220, 255, 0.45);
      border-radius: 50%;
      animation: float 14s linear infinite;
    }

    .hero-inner {
      position: relative;
      z-index: 2;
      width: min(920px, 92vw);
      padding: 28px;
    }

    .brand {
      font-size: 0.9rem;
      letter-spacing: 0.3em;
      text-transform: uppercase;
      color: #7ec4ff;
      margin-bottom: 20px;
      opacity: 0.9;
    }

    .hero h1 {
      margin: 0;
      font-size: clamp(2rem, 6.4vw, 4.7rem);
      line-height: 1.03;
      letter-spacing: 0.02em;
      text-wrap: balance;
      text-transform: uppercase;
      text-shadow: 0 18px 36px rgba(0, 0, 0, 0.45);
    }

    .hero p {
      margin: 1rem auto 0;
      font-size: clamp(1rem, 2vw, 1.3rem);
      max-width: 720px;
      color: #cdd7f3;
    }

    .hero-tag {
      display: inline-flex;
      margin-top: 22px;
      border: 1px solid rgba(136, 171, 255, 0.26);
      padding: 10px 16px;
      border-radius: 999px;
      font-size: 0.86rem;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      background: rgba(20, 29, 50, 0.45);
    }

    .app {
      position: relative;
      z-index: 3;
      width: min(1200px, 94vw);
      margin: 100vh auto 0;
      padding-bottom: 120px;
    }

    .topbar {
      position: sticky;
      top: 0;
      z-index: 12;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
      padding: 14px 0;
      backdrop-filter: blur(8px);
      background: linear-gradient(to bottom, rgba(7, 9, 15, 0.9), rgba(7, 9, 15, 0.38));
    }

    .logo {
      font-weight: 900;
      letter-spacing: 0.06em;
      font-size: 1.1rem;
    }

    .topic-row {
      display: flex;
      gap: 10px;
      flex-wrap: nowrap;
      overflow-x: auto;
      padding: 12px 0 14px;
      scrollbar-width: none;
    }

    .topic-row::-webkit-scrollbar {
      display: none;
    }

    .topic-pill {
      border: 1px solid rgba(141, 181, 255, 0.3);
      color: #cfe3ff;
      background: rgba(15, 27, 48, 0.7);
      border-radius: 999px;
      padding: 9px 16px;
      font-weight: 700;
      letter-spacing: 0.01em;
      white-space: nowrap;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .topic-pill.active {
      color: #07101f;
      background: linear-gradient(120deg, #84d2ff, #d7f5ff);
      border-color: transparent;
      box-shadow: 0 0 0 3px rgba(122, 194, 255, 0.22);
    }

    .layout {
      display: grid;
      grid-template-columns: minmax(0, 1fr) 320px;
      gap: 20px;
      align-items: start;
    }

    .feed {
      display: grid;
      gap: 14px;
    }

    .card {
      background: var(--card);
      border: 1px solid var(--card-border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 18px;
      cursor: pointer;
      transition: transform 0.22s ease, border-color 0.22s ease;
    }

    .card:hover {
      transform: translateY(-4px);
      border-color: rgba(163, 195, 255, 0.42);
    }

    .meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      color: var(--muted);
      font-size: 0.82rem;
      margin-bottom: 10px;
    }

    .topic-chip {
      padding: 4px 8px;
      border-radius: 999px;
      border: 1px solid rgba(145, 179, 255, 0.2);
      background: rgba(12, 18, 34, 0.5);
      color: #b9c7e8;
      font-size: 0.74rem;
      letter-spacing: 0.03em;
      text-transform: uppercase;
    }

    .secret-text {
      margin: 0;
      font-size: 1.03rem;
      line-height: 1.52;
      color: #f2f5ff;
      text-wrap: pretty;
    }

    .reactions {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
      margin-top: 14px;
    }

    .reaction-left {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      align-items: center;
    }

    .reaction-divider {
      width: 1px;
      height: 28px;
      background: rgba(146, 169, 216, 0.28);
    }

    .pill {
      border: 1px solid rgba(145, 166, 210, 0.38);
      background: rgba(11, 17, 32, 0.72);
      border-radius: 999px;
      color: #e7eeff;
      height: 44px;
      min-width: 60px;
      padding: 0 14px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 7px;
      font-weight: 700;
      font-size: 0.92rem;
      cursor: pointer;
      transition: all 0.2s ease;
      user-select: none;
    }

    .pill.reply {
      min-width: 112px;
      border-color: rgba(111, 184, 255, 0.45);
    }

    .pill.active-hug {
      border-color: rgba(245, 174, 69, 0.8);
      box-shadow: 0 0 0 3px rgba(245, 174, 69, 0.23);
      color: #ffd499;
    }

    .pill.active-omg {
      border-color: rgba(171, 126, 255, 0.84);
      box-shadow: 0 0 0 3px rgba(169, 126, 255, 0.2);
      color: #decfff;
    }

    .pill.active-meh {
      border-color: rgba(151, 162, 179, 0.82);
      box-shadow: 0 0 0 3px rgba(123, 133, 150, 0.2);
      color: #d2d8e4;
    }

    .pill.active-reply {
      border-color: rgba(100, 182, 255, 0.84);
      box-shadow: 0 0 0 3px rgba(100, 182, 255, 0.23);
      color: #cfe9ff;
    }

    .bounce {
      animation: tapBounce 0.2s ease;
    }

    .sidebar {
      position: sticky;
      top: 74px;
      display: grid;
      gap: 12px;
    }

    .panel {
      background: rgba(11, 16, 30, 0.8);
      border: 1px solid rgba(124, 154, 214, 0.2);
      border-radius: 16px;
      padding: 14px;
    }

    .panel h2 {
      margin: 0 0 8px;
      font-size: 1rem;
      letter-spacing: 0.04em;
      text-transform: uppercase;
    }

    .rank-list {
      display: grid;
      gap: 8px;
    }

    .rank-item {
      border: 1px solid rgba(129, 161, 223, 0.2);
      border-radius: 12px;
      padding: 10px;
      background: rgba(16, 23, 42, 0.62);
      cursor: pointer;
    }

    .rank-item:hover {
      border-color: rgba(161, 193, 255, 0.45);
    }

    .rank-head {
      display: flex;
      justify-content: space-between;
      gap: 8px;
      color: #cfe0ff;
      font-size: 0.8rem;
      margin-bottom: 5px;
    }

    .rank-text {
      margin: 0;
      font-size: 0.86rem;
      color: #d7e2ff;
      line-height: 1.35;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .badge {
      margin-top: 7px;
      display: inline-flex;
      font-size: 0.73rem;
      padding: 4px 8px;
      border-radius: 999px;
      background: rgba(20, 31, 56, 0.95);
      border: 1px solid rgba(132, 159, 216, 0.4);
      color: #d8e6ff;
    }

    .detail {
      position: fixed;
      inset: 0;
      background: rgba(4, 7, 12, 0.86);
      backdrop-filter: blur(4px);
      z-index: 40;
      display: grid;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.28s ease;
    }

    .detail.open {
      opacity: 1;
      pointer-events: auto;
    }

    .detail-shell {
      align-self: end;
      background: linear-gradient(180deg, #0b1120, #090d18);
      width: min(920px, 100%);
      justify-self: center;
      height: min(100dvh, 100%);
      border-radius: 18px 18px 0 0;
      border: 1px solid rgba(144, 171, 227, 0.28);
      transform: translateY(100%);
      transition: transform 0.34s ease;
      display: grid;
      grid-template-rows: auto 1fr auto;
      overflow: hidden;
    }

    .detail.open .detail-shell {
      transform: translateY(0);
    }

    .detail-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
      padding: 12px 14px;
      border-bottom: 1px solid rgba(121, 148, 206, 0.25);
      background: rgba(14, 20, 34, 0.88);
    }

    .ghost-btn {
      border: 1px solid rgba(134, 161, 214, 0.4);
      color: #d8e5ff;
      background: rgba(16, 24, 44, 0.88);
      border-radius: 12px;
      padding: 8px 10px;
      cursor: pointer;
      font-weight: 700;
    }

    .detail-main {
      overflow-y: auto;
      padding: 16px;
      padding-bottom: 130px;
    }

    .detail-secret {
      background: rgba(15, 23, 42, 0.72);
      border: 1px solid rgba(120, 149, 208, 0.2);
      border-radius: 14px;
      padding: 14px;
      margin-bottom: 14px;
    }

    .sort-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin: 10px 0;
      gap: 10px;
      flex-wrap: wrap;
    }

    .sort-set {
      display: inline-flex;
      border-radius: 999px;
      border: 1px solid rgba(130, 160, 218, 0.3);
      overflow: hidden;
    }

    .sort-btn {
      border: 0;
      background: rgba(17, 26, 46, 0.7);
      color: #d7e3ff;
      padding: 8px 12px;
      cursor: pointer;
      font-weight: 700;
      font-size: 0.86rem;
    }

    .sort-btn.active {
      background: #66b9ff;
      color: #071324;
    }

    .reply-list {
      display: grid;
      gap: 8px;
    }

    .reply {
      border: 1px solid rgba(118, 145, 199, 0.22);
      background: rgba(13, 20, 36, 0.75);
      border-radius: 12px;
      padding: 10px;
    }

    .reply-head {
      display: flex;
      justify-content: space-between;
      align-items: center;
      color: #b8c9eb;
      gap: 12px;
      font-size: 0.79rem;
      margin-bottom: 7px;
    }

    .reply-meta {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      flex-wrap: wrap;
    }

    .op-pill {
      border: 1px solid rgba(113, 252, 196, 0.44);
      color: #8fffd2;
      border-radius: 999px;
      font-size: 0.69rem;
      padding: 2px 7px;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .reply-actions {
      display: inline-flex;
      gap: 6px;
    }

    .mini {
      height: 30px;
      min-width: 54px;
      padding: 0 9px;
      font-size: 0.8rem;
      border-radius: 999px;
      border: 1px solid rgba(125, 151, 205, 0.35);
      background: rgba(12, 17, 30, 0.76);
      color: #dce8ff;
      cursor: pointer;
    }

    .detail-input {
      position: sticky;
      bottom: 0;
      z-index: 3;
      background: rgba(9, 13, 23, 0.96);
      border-top: 1px solid rgba(115, 139, 187, 0.3);
      padding: 10px;
      display: grid;
      gap: 8px;
    }

    .reply-text {
      width: 100%;
      min-height: 54px;
      max-height: 120px;
      resize: none;
      border-radius: 12px;
      border: 1px solid rgba(125, 154, 210, 0.34);
      background: rgba(15, 22, 39, 0.9);
      color: #edf3ff;
      padding: 10px;
      font: inherit;
    }

    .reply-send {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
    }

    .send-btn {
      border: 0;
      border-radius: 10px;
      padding: 10px 14px;
      background: linear-gradient(120deg, #7bc7ff, #9ad3ff);
      color: #041124;
      font-weight: 900;
      letter-spacing: 0.04em;
      cursor: pointer;
    }

    .empty {
      color: #9eb0d8;
      text-align: center;
      padding: 18px;
      border: 1px dashed rgba(138, 165, 218, 0.3);
      border-radius: 14px;
    }

    @keyframes tapBounce {
      0% { transform: scale(1); }
      50% { transform: scale(1.3); }
      100% { transform: scale(1); }
    }

    @keyframes drift {
      0% { transform: translate3d(-8%, -6%, 0) rotate(0deg); }
      100% { transform: translate3d(7%, 5%, 0) rotate(8deg); }
    }

    @keyframes float {
      0% { transform: translateY(0); opacity: 0; }
      8% { opacity: 1; }
      100% { transform: translateY(-110vh); opacity: 0; }
    }

    @media (max-width: 1024px) {
      .layout { grid-template-columns: 1fr; }
      .sidebar { position: static; }
      .panel { order: 2; }
    }

    @media (max-width: 780px) {
      .app { width: 95vw; }
      .hero h1 { letter-spacing: 0.01em; }
      .card { padding: 14px; }
      .detail-shell {
        width: 100%;
        border-radius: 0;
        height: 100dvh;
      }
      .detail-main { padding: 12px; padding-bottom: 132px; }
      .pill.reply { min-width: 94px; }
    }
  </style>
</head>
<body>
  <section class="hero" id="hero">
    <div class="particles" id="particles"></div>
    <div class="hero-inner">
      <div class="brand">TellAnything</div>
      <h1>You hide your name. Not your truth.</h1>
      <p>What would you say if no one knew it was you? TellAnything is where confessions hit hard and strangers answer back.</p>
      <div class="hero-tag">The truth has no name</div>
    </div>
  </section>

  <main class="app">
    <div class="topbar">
      <div class="logo">TellAnything</div>
      <div style="color:#95a8d2;font-size:.83rem;">Anonymous secrets. Raw reactions.</div>
    </div>

    <div class="topic-row" id="topicRow"></div>

    <section class="layout">
      <div class="feed" id="feed"></div>
      <aside class="sidebar">
        <div class="panel">
          <h2>Top 10 Tonight</h2>
          <div class="rank-list" id="rankList"></div>
        </div>
      </aside>
    </section>
  </main>

  <section class="detail" id="detail">
    <div class="detail-shell">
      <div class="detail-header">
        <button class="ghost-btn" id="backBtn">Back</button>
        <div id="detailMeta" style="color:#a8b8df;font-size:.86rem;"></div>
      </div>
      <div class="detail-main" id="detailMain"></div>
      <div class="detail-input">
        <textarea id="replyText" class="reply-text" maxlength="500" placeholder="Reply anonymously..."></textarea>
        <div class="reply-send">
          <div id="replyCounter" style="color:#9cb0db;font-size:.78rem;">500</div>
          <button class="send-btn" id="sendReply">Send</button>
        </div>
      </div>
    </div>
  </section>

  <script>
    const topicOrder = ["all", "work", "relationships", "family", "money", "school", "health", "crime", "social", "funny"];

    const aliasPool = [
      "Anonymous_Hex", "Anonymous_Drift", "Anonymous_Sparrow", "Anonymous_Glass", "Anonymous_Fable",
      "Anonymous_Ghost", "Anonymous_Nova", "Anonymous_Mask", "Anonymous_Crow", "Anonymous_Vault",
      "Anonymous_River", "Anonymous_Ash", "Anonymous_Wolf", "Anonymous_Echo", "Anonymous_Night"
    ];

    const replyUsers = [
      "HiddenFox", "QuietIris", "MutedComet", "GhostPeach", "PaperTiger", "NightOwl", "ShyStatic", "ColdCoffee",
      "SleepyRiot", "SoftBlunt", "DeadpanDawn", "LittleThunder", "CipherLemon", "BlueVenom", "VelvetCrow"
    ];

    const baseSecrets = [
      {
        topic: "relationships",
        timestamp: "3 hours ago",
        text: "I said I was working late for six months. I was parked behind a grocery store eating takeout alone because I couldn't stand going home.",
        reactions: { hug: 118, omg: 49, meh: 5 },
        replies: [
          "That line hit too close. Parking lots became my therapy too.",
          "I thought I was the only one doing fake overtime to breathe.",
          "This is sad but weirdly real. Hope you found a way out.",
          "I did this during my engagement and still got married anyway. Mistake."
        ]
      },
      {
        topic: "work",
        timestamp: "1 hour ago",
        text: "I automated 80% of my job and spend most days pretending to look stressed so my boss thinks I'm overloaded.",
        reactions: { hug: 92, omg: 84, meh: 9 },
        replies: [
          "Corporate survival skill unlocked.",
          "Same. My weekly report is basically copy/paste theater.",
          "Don't expose us all at once.",
          "You deserve a raise for being efficient, not punished with extra work."
        ]
      },
      {
        topic: "family",
        timestamp: "9 hours ago",
        text: "My dad has a second phone labeled 'Tax Office' in his contacts. It is absolutely not the tax office.",
        reactions: { hug: 44, omg: 132, meh: 7 },
        replies: [
          "The fake contact name is always how they get caught.",
          "My uncle did this with 'dentist.' Same story.",
          "I laughed and then remembered my mom has 'gym coach.'"
        ]
      },
      {
        topic: "money",
        timestamp: "2 days ago",
        text: "I won $12k sports betting and told everyone at work I inherited it from a distant aunt so they wouldn't ask for picks.",
        reactions: { hug: 57, omg: 76, meh: 11 },
        replies: [
          "Inheritance lie is elite because nobody asks follow-ups.",
          "If you give picks once, they blame you forever.",
          "Respectfully, I'd still ask for one parlay.",
          "I told people crypto. Inheritance was smarter."
        ]
      },
      {
        topic: "school",
        timestamp: "5 hours ago",
        text: "I wrote my college admissions essay about grief. It was actually copied from my friend's journal with details changed.",
        reactions: { hug: 31, omg: 111, meh: 15 },
        replies: [
          "This is villain origin behavior.",
          "Admissions essays are performance anyway, but wow.",
          "I cannot decide if this is genius or evil.",
          "Please never run for office."
        ]
      },
      {
        topic: "funny",
        timestamp: "40 minutes ago",
        text: "I fake-laughed at my manager's joke so hard I snorted coffee. Now he keeps telling jokes to hear me do it again.",
        reactions: { hug: 141, omg: 39, meh: 4 },
        replies: [
          "You accidentally created a workplace character.",
          "Method acting but for employment.",
          "This is me every all-hands call."
        ]
      },
      {
        topic: "health",
        timestamp: "7 hours ago",
        text: "My doctor says my blood pressure spikes at work. I told HR I need wellness breaks. I actually sit in my car and scream.",
        reactions: { hug: 166, omg: 54, meh: 6 },
        replies: [
          "Screaming in the car is cheaper than therapy and somehow worse.",
          "I've done this in parking garages for years.",
          "Please also drink water. rage dehydration is real.",
          "If this isn't burnout, what is?"
        ]
      },
      {
        topic: "crime",
        timestamp: "12 hours ago",
        text: "I found out my roommate steals tiny amounts of cash from guests and calls it 'hospitality tax.'",
        reactions: { hug: 22, omg: 147, meh: 13 },
        replies: [
          "Hospitality tax is unhinged branding.",
          "You need a lockbox and a new roommate.",
          "Tiny theft adds up fast. that's felony speedrun.",
          "Imagine explaining this in court with a straight face."
        ]
      },
      {
        topic: "relationships",
        timestamp: "4 hours ago",
        text: "I still stalk my ex's playlist every Friday because I can tell when they're sad by the song order.",
        reactions: { hug: 135, omg: 47, meh: 12 },
        replies: [
          "Digital astrology for heartbreak.",
          "I used to do this with Spotify too. zero shame.",
          "This is creepy and also kind of poetic.",
          "Block and heal. kindly."
        ]
      },
      {
        topic: "work",
        timestamp: "3 days ago",
        text: "Our team lead's 'urgent' Slack messages are scheduled drafts so she looks productive at 6am.",
        reactions: { hug: 88, omg: 95, meh: 16 },
        replies: [
          "The 6am grindset cosplay is everywhere.",
          "I knew it. nobody types 'quick one' before sunrise.",
          "Set your own drafts at 5:59 and establish dominance."
        ]
      },
      {
        topic: "family",
        timestamp: "6 hours ago",
        text: "My mom still tells people I was a gifted kid. I got diagnosed with ADHD at 30 and suddenly my whole childhood made sense.",
        reactions: { hug: 189, omg: 36, meh: 3 },
        replies: [
          "Late diagnosis is grieving and relief at the same time.",
          "You're not broken. your brain just needed the right map.",
          "Same timeline for me. changed my life.",
          "Gifted kid to exhausted adult pipeline is real."
        ]
      },
      {
        topic: "money",
        timestamp: "11 hours ago",
        text: "I keep a spreadsheet of every friend who says 'I got you next time.' There are no next times.",
        reactions: { hug: 154, omg: 62, meh: 8 },
        replies: [
          "Data-driven pettiness is my love language.",
          "Send invoices quarterly.",
          "I stopped spotting people and my stress dropped instantly."
        ]
      },
      {
        topic: "social",
        timestamp: "2 hours ago",
        text: "I post mental health quotes online and then ghost everyone who checks in because I don't know how to receive kindness.",
        reactions: { hug: 173, omg: 33, meh: 2 },
        replies: [
          "This is painfully honest.",
          "Receiving care is harder than posting about pain.",
          "Small step: reply with one sentence. that's enough.",
          "You're not manipulative, you're scared."
        ]
      },
      {
        topic: "school",
        timestamp: "20 hours ago",
        text: "I charge classmates to proofread their essays. I use AI and pretend I stayed up all night editing.",
        reactions: { hug: 52, omg: 101, meh: 17 },
        replies: [
          "The business model is shameless and efficient.",
          "At least verify grammar before cashing out.",
          "Half my campus is doing this quietly.",
          "You're either an entrepreneur or a cautionary tale."
        ]
      },
      {
        topic: "funny",
        timestamp: "8 hours ago",
        text: "I accidentally sent a voice note of me trash-talking my date... to my date. We've been together for 8 months now.",
        reactions: { hug: 97, omg: 128, meh: 6 },
        replies: [
          "This is either fate or blackmail.",
          "Honesty speedrun worked for you somehow.",
          "Need the exact transcript for science.",
          "If they stayed after that, keep them."
        ]
      },
      {
        topic: "health",
        timestamp: "14 hours ago",
        text: "I tell people I run at 6am. I just walk to a bakery in leggings and buy pastries before sunrise.",
        reactions: { hug: 122, omg: 45, meh: 10 },
        replies: [
          "Cardio to carbs pipeline.",
          "Honestly this sounds like joy.",
          "You still woke up early. points awarded.",
          "The bakery probably knows your fake marathon era."
        ]
      },
      {
        topic: "crime",
        timestamp: "2 hours ago",
        text: "I reported my own stolen bike for insurance. I had actually sold it months earlier and forgot.",
        reactions: { hug: 21, omg: 140, meh: 19 },
        replies: [
          "This confession is chaos in legal form.",
          "Delete this and call a lawyer.",
          "'Forgot I sold it' is absurdly believable.",
          "You snitched on yourself. iconic."
        ]
      },
      {
        topic: "relationships",
        timestamp: "16 hours ago",
        text: "I stayed in a relationship because his dog loved me. We broke up and I still miss the dog more.",
        reactions: { hug: 204, omg: 40, meh: 4 },
        replies: [
          "Pet custody should be standard in breakups.",
          "I cried at this because same.",
          "Dogs are always the best part of bad men.",
          "Hope you two reunite at a park by accident."
        ]
      },
      {
        topic: "work",
        timestamp: "6 days ago",
        text: "I approved a campaign typo on purpose because my manager ignored every correction I made for months.",
        reactions: { hug: 71, omg: 118, meh: 14 },
        replies: [
          "Passive-aggressive justice system.",
          "I know this was wrong and I still smiled.",
          "Management only learns through embarrassment sometimes.",
          "This belongs in the petty hall of fame."
        ]
      },
      {
        topic: "family",
        timestamp: "1 day ago",
        text: "My sister and I still use a fake happy group chat to keep our parents from asking why we barely speak.",
        reactions: { hug: 183, omg: 51, meh: 5 },
        replies: [
          "Family PR is exhausting.",
          "My cousins do this too. annual holiday peace treaty.",
          "Pretend harmony is such a common survival tactic.",
          "I hope you two get a real conversation someday."
        ]
      },
      {
        topic: "money",
        timestamp: "3 hours ago",
        text: "I got a promotion and still tell friends I'm broke so they stop asking me to split expensive dinners.",
        reactions: { hug: 109, omg: 58, meh: 9 },
        replies: [
          "Boundaries with a fake budget is still boundaries.",
          "Just say no. lying scales badly.",
          "Expensive dinner friends vanish when checks arrive.",
          "I feel seen and attacked."
        ]
      },
      {
        topic: "social",
        timestamp: "9 minutes ago",
        text: "I mute every group chat but still panic-check them every 12 minutes because I can't stand being forgotten.",
        reactions: { hug: 147, omg: 22, meh: 3 },
        replies: [
          "This is modern anxiety in one sentence.",
          "Mute is peace, FOMO is war.",
          "I archive chats then stalk notifications anyway.",
          "You're not alone in this spiral."
        ]
      },
      {
        topic: "school",
        timestamp: "4 days ago",
        text: "I tutor freshmen in calculus. I failed calculus twice and now I teach from old answer keys.",
        reactions: { hug: 63, omg: 97, meh: 13 },
        replies: [
          "Those who suffered teach.",
          "As long as they pass, maybe this is poetic justice.",
          "Please learn the concepts before finals week disaster.",
          "Failure-to-teacher arc is wild."
        ]
      },
      {
        topic: "health",
        timestamp: "10 hours ago",
        text: "I tell my therapist I'm making progress. I mostly rehearse fake breakthroughs on the drive over.",
        reactions: { hug: 161, omg: 67, meh: 4 },
        replies: [
          "Therapy about lying in therapy is still progress.",
          "Please tell them this exact sentence next session.",
          "You're paying to perform pain. been there.",
          "The honesty in this confession is a start."
        ]
      },
      {
        topic: "funny",
        timestamp: "15 hours ago",
        text: "I pretend my cat needs medication at 9pm so guests leave on time. The cat is healthy and judgmental.",
        reactions: { hug: 132, omg: 42, meh: 6 },
        replies: [
          "Cat-assisted boundaries are elite.",
          "Stealing this. sorry not sorry.",
          "Your cat definitely knows it's part of the lie.",
          "I use 'early gym.' cat is way better."
        ]
      }
    ];

    const state = {
      filter: "all",
      secrets: [],
      selectedSecretId: null,
      replySort: "relatable",
      activeSecretReactions: {},
      activeReplyReactions: {},
      heroLocked: false,
      savedScrollY: 0
    };

    const byId = {
      app: document.querySelector(".app"),
      feed: document.getElementById("feed"),
      rankList: document.getElementById("rankList"),
      topicRow: document.getElementById("topicRow"),
      detail: document.getElementById("detail"),
      detailMain: document.getElementById("detailMain"),
      detailMeta: document.getElementById("detailMeta"),
      backBtn: document.getElementById("backBtn"),
      sendReply: document.getElementById("sendReply"),
      replyText: document.getElementById("replyText"),
      replyCounter: document.getElementById("replyCounter"),
      hero: document.getElementById("hero"),
      particles: document.getElementById("particles")
    };

    function seededRand(seed) {
      return Math.abs(Math.sin(seed * 999)) % 1;
    }

    function bootstrapData() {
      state.secrets = baseSecrets.map((item, idx) => {
        const id = idx + 1;
        const username = aliasPool[idx % aliasPool.length] + id;
        const replies = item.replies.map((txt, i) => ({
          id: id * 100 + i + 1,
          user: replyUsers[(idx * 3 + i) % replyUsers.length],
          text: txt,
          timestamp: ["9m ago", "22m ago", "1h ago", "3h ago", "7h ago"][i % 5],
          reactions: {
            hug: Math.floor(seededRand(id * (i + 2)) * 26) + 1,
            omg: Math.floor(seededRand(id * (i + 4)) * 12)
          },
          isOP: i === 0 && idx % 5 === 0
        }));

        return {
          id,
          username,
          text: item.text,
          topic: item.topic,
          timestamp: item.timestamp,
          reactions: { ...item.reactions },
          replyCount: replies.length,
          replies
        };
      });
    }

    function ensureConsistency() {
      state.secrets.forEach(secret => {
        secret.replyCount = secret.replies.length;
      });
    }

    function parseAgeHours(label) {
      const m = String(label).toLowerCase().match(/(\d+)\s*(minute|minutes|min|m|hour|hours|h|day|days|d|week|weeks|w)/);
      if (!m) return 72;
      const n = Number(m[1]);
      const unit = m[2];
      if (unit.startsWith("m") && unit !== "month") return n / 60;
      if (unit.startsWith("h")) return n;
      if (unit.startsWith("d")) return n * 24;
      if (unit.startsWith("w")) return n * 24 * 7;
      return 72;
    }

    function engagementScore(secret) {
      const hug = secret.reactions.hug;
      const omg = secret.reactions.omg;
      const meh = secret.reactions.meh;
      const base = (hug * 3) + (omg * 2) + (secret.replyCount * 4) - meh;
      const ageHours = parseAgeHours(secret.timestamp);
      const timeFactor = Math.max(0.5, 1 - ageHours / 168);
      return Math.max(0, Math.round(base * timeFactor));
    }

    function badgeFor(secret) {
      const rel = secret.reactions.hug;
      const shock = secret.reactions.omg;
      const discussed = secret.replyCount * 9;
      if (discussed >= rel && discussed >= shock) return "ðŸ’¬ Most Discussed";
      if (shock >= rel) return "ðŸ˜± Most Shocking";
      return "ðŸ«‚ Most Relatable";
    }

    function topicList() {
      return topicOrder.filter(topic => topic === "all" || state.secrets.some(s => s.topic === topic));
    }

    function activeMap(secretId) {
      if (!state.activeSecretReactions[secretId]) {
        state.activeSecretReactions[secretId] = { hug: false, omg: false, meh: false };
      }
      return state.activeSecretReactions[secretId];
    }

    function activeReplyMap(replyId) {
      if (!state.activeReplyReactions[replyId]) {
        state.activeReplyReactions[replyId] = { hug: false, omg: false };
      }
      return state.activeReplyReactions[replyId];
    }

    function filteredSecrets() {
      if (state.filter === "all") return state.secrets;
      return state.secrets.filter(s => s.topic === state.filter);
    }

    function drawTopics() {
      byId.topicRow.innerHTML = topicList().map(topic => {
        const active = state.filter === topic ? "active" : "";
        const label = topic === "all" ? "All" : topic[0].toUpperCase() + topic.slice(1);
        return `<button class="topic-pill ${active}" data-topic="${topic}">${label}</button>`;
      }).join("");
    }

    function pillLabel(count, type) {
      if (type !== "reply") return String(count);
      return count > 0 ? `${count} replies` : "Reply";
    }

    function drawFeed() {
      const cards = filteredSecrets().map(secret => {
        const active = activeMap(secret.id);
        return `
          <article class="card" data-open-id="${secret.id}">
            <div class="meta">
              <span>${secret.username} Â· ${secret.timestamp}</span>
              <span class="topic-chip">${secret.topic}</span>
            </div>
            <p class="secret-text">${escapeHtml(secret.text)}</p>
            <div class="reactions">
              <div class="reaction-left">
                <button class="pill ${active.hug ? "active-hug" : ""}" data-react="hug" data-id="${secret.id}">ðŸ«‚ <span>${secret.reactions.hug}</span></button>
                <button class="pill ${active.omg ? "active-omg" : ""}" data-react="omg" data-id="${secret.id}">ðŸ˜± <span>${secret.reactions.omg}</span></button>
                <button class="pill ${active.meh ? "active-meh" : ""}" data-react="meh" data-id="${secret.id}">ðŸ¥± <span>${secret.reactions.meh}</span></button>
              </div>
              <div class="reaction-left">
                <div class="reaction-divider"></div>
                <button class="pill reply active-reply" data-open-id="${secret.id}">ðŸ’¬ <span>${pillLabel(secret.replyCount, "reply")}</span></button>
              </div>
            </div>
          </article>
        `;
      }).join("");

      byId.feed.innerHTML = cards || `<div class="empty">No secrets in this topic yet.</div>`;
    }

    function drawTopRank() {
      const top = [...state.secrets]
        .sort((a, b) => engagementScore(b) - engagementScore(a))
        .slice(0, 10);

      byId.rankList.innerHTML = top.map((s, i) => `
        <article class="rank-item" data-open-id="${s.id}">
          <div class="rank-head"><span>#${i + 1}</span><span>${engagementScore(s)} pts</span></div>
          <p class="rank-text">${escapeHtml(s.text)}</p>
          <div class="badge">${badgeFor(s)}</div>
        </article>
      `).join("");
    }

    function renderAll() {
      ensureConsistency();
      drawTopics();
      drawFeed();
      drawTopRank();
    }

    function openDetail(secretId, pushHash = true) {
      const secret = state.secrets.find(s => s.id === secretId);
      if (!secret) return;
      state.selectedSecretId = secretId;
      state.savedScrollY = window.scrollY;
      byId.detail.classList.add("open");
      byId.detailMeta.textContent = `${secret.username} Â· ${secret.timestamp}`;
      if (pushHash) location.hash = `#/s/${secretId}`;
      renderDetail();
      byId.replyText.focus();
    }

    function closeDetail(popHash = true) {
      byId.detail.classList.remove("open");
      state.selectedSecretId = null;
      if (popHash && location.hash.startsWith("#/s/")) {
        history.pushState("", document.title, window.location.pathname + window.location.search);
      }
      window.scrollTo({ top: state.savedScrollY || 0, behavior: "smooth" });
    }

    function sortReplies(list) {
      const arr = [...list];
      if (state.replySort === "newest") {
        return arr.sort((a, b) => b.id - a.id);
      }
      return arr.sort((a, b) => (b.reactions.hug - a.reactions.hug) || (b.id - a.id));
    }

    function renderDetail() {
      const secret = state.secrets.find(s => s.id === state.selectedSecretId);
      if (!secret) return;
      const act = activeMap(secret.id);

      const replies = sortReplies(secret.replies).map(reply => {
        const rAct = activeReplyMap(reply.id);
        return `
          <article class="reply">
            <div class="reply-head">
              <div class="reply-meta">
                <strong>${reply.user}</strong>
                <span>${reply.timestamp}</span>
                ${reply.isOP ? '<span class="op-pill">OP</span>' : ""}
              </div>
              <div class="reply-actions">
                <button class="mini ${rAct.hug ? "active-hug" : ""}" data-reply-react="hug" data-reply-id="${reply.id}">ðŸ«‚ ${reply.reactions.hug}</button>
                <button class="mini ${rAct.omg ? "active-omg" : ""}" data-reply-react="omg" data-reply-id="${reply.id}">ðŸ˜± ${reply.reactions.omg}</button>
              </div>
            </div>
            <div>${escapeHtml(reply.text)}</div>
          </article>
        `;
      }).join("");

      byId.detailMain.innerHTML = `
        <section class="detail-secret">
          <div class="meta">
            <span>${secret.username}</span>
            <span class="topic-chip">${secret.topic}</span>
          </div>
          <p class="secret-text">${escapeHtml(secret.text)}</p>
          <div class="reactions">
            <div class="reaction-left">
              <button class="pill ${act.hug ? "active-hug" : ""}" data-react="hug" data-id="${secret.id}">ðŸ«‚ <span>${secret.reactions.hug}</span></button>
              <button class="pill ${act.omg ? "active-omg" : ""}" data-react="omg" data-id="${secret.id}">ðŸ˜± <span>${secret.reactions.omg}</span></button>
              <button class="pill ${act.meh ? "active-meh" : ""}" data-react="meh" data-id="${secret.id}">ðŸ¥± <span>${secret.reactions.meh}</span></button>
            </div>
          </div>
        </section>

        <div class="sort-row">
          <h3 style="margin:0;font-size:1rem;">${secret.replyCount} Anonymous Responses</h3>
          <div class="sort-set">
            <button class="sort-btn ${state.replySort === "relatable" ? "active" : ""}" data-sort="relatable">Most Relatable</button>
            <button class="sort-btn ${state.replySort === "newest" ? "active" : ""}" data-sort="newest">Newest</button>
          </div>
        </div>

        <section class="reply-list">${replies || '<div class="empty">No replies yet. Be the first.</div>'}</section>
      `;
    }

    function triggerBounce(el) {
      el.classList.remove("bounce");
      void el.offsetWidth;
      el.classList.add("bounce");
    }

    function reactToSecret(secretId, type, button) {
      const secret = state.secrets.find(s => s.id === secretId);
      if (!secret) return;
      const active = activeMap(secretId);
      const wasActive = active[type];
      active[type] = !wasActive;
      secret.reactions[type] += wasActive ? -1 : 1;
      triggerBounce(button);
      renderAll();
      if (state.selectedSecretId === secretId) renderDetail();
    }

    function reactToReply(replyId, type, button) {
      const secret = state.secrets.find(s => s.id === state.selectedSecretId);
      if (!secret) return;
      const reply = secret.replies.find(r => r.id === replyId);
      if (!reply) return;
      const active = activeReplyMap(replyId);
      const wasActive = active[type];
      active[type] = !wasActive;
      reply.reactions[type] += wasActive ? -1 : 1;
      triggerBounce(button);
      renderDetail();
      drawTopRank();
    }

    function onSendReply() {
      const secret = state.secrets.find(s => s.id === state.selectedSecretId);
      if (!secret) return;
      const text = byId.replyText.value.trim();
      if (!text) return;
      const nextId = secret.id * 1000 + secret.replies.length + 1;
      secret.replies.push({
        id: nextId,
        user: replyUsers[(nextId + secret.id) % replyUsers.length],
        text,
        timestamp: "just now",
        reactions: { hug: 0, omg: 0 },
        isOP: false
      });
      secret.replyCount = secret.replies.length;
      byId.replyText.value = "";
      byId.replyCounter.textContent = "500";
      renderAll();
      renderDetail();
    }

    function onAppClick(e) {
      const topicBtn = e.target.closest("[data-topic]");
      if (topicBtn) {
        state.filter = topicBtn.dataset.topic;
        drawTopics();
        drawFeed();
        return;
      }

      const reactBtn = e.target.closest("[data-react]");
      if (reactBtn) {
        e.stopPropagation();
        reactToSecret(Number(reactBtn.dataset.id), reactBtn.dataset.react, reactBtn);
        return;
      }

      const open = e.target.closest("[data-open-id]");
      if (open) {
        openDetail(Number(open.dataset.openId));
      }
    }

    function onDetailClick(e) {
      const reactBtn = e.target.closest("[data-react]");
      if (reactBtn) {
        reactToSecret(Number(reactBtn.dataset.id), reactBtn.dataset.react, reactBtn);
        return;
      }

      const replyReact = e.target.closest("[data-reply-react]");
      if (replyReact) {
        reactToReply(Number(replyReact.dataset.replyId), replyReact.dataset.replyReact, replyReact);
        return;
      }

      const sortBtn = e.target.closest("[data-sort]");
      if (sortBtn) {
        state.replySort = sortBtn.dataset.sort;
        renderDetail();
      }
    }

    function buildParticles() {
      const total = 48;
      const out = [];
      for (let i = 0; i < total; i++) {
        const left = Math.floor(Math.random() * 100);
        const delay = (Math.random() * 12).toFixed(2);
        const dur = (10 + Math.random() * 12).toFixed(2);
        out.push(`<span style="left:${left}%; bottom:-5%; animation-delay:${delay}s; animation-duration:${dur}s;"></span>`);
      }
      byId.particles.innerHTML = out.join("");
    }

    function onParallaxScroll() {
      const y = window.scrollY;
      byId.hero.style.transform = `translateY(${-y * 1.5}px)`;

      if (y === 0) state.heroLocked = false;
      if (y > window.innerHeight * 0.45) state.heroLocked = true;

      const fading = Math.max(0, 1 - y / (window.innerHeight * 0.6));
      byId.hero.style.opacity = state.heroLocked ? "0" : String(fading);
      byId.hero.style.pointerEvents = state.heroLocked ? "none" : "auto";
    }

    function syncHash() {
      const m = location.hash.match(/^#\/s\/(\d+)$/);
      if (m) {
        const id = Number(m[1]);
        if (state.secrets.some(s => s.id === id)) {
          openDetail(id, false);
        }
      }
    }

    function escapeHtml(str) {
      return str
        .replaceAll("&", "&amp;")
        .replaceAll("<", "&lt;")
        .replaceAll(">", "&gt;")
        .replaceAll('"', "&quot;")
        .replaceAll("'", "&#39;");
    }

    function init() {
      bootstrapData();
      ensureConsistency();
      buildParticles();
      renderAll();
      syncHash();
      onParallaxScroll();

      byId.app.addEventListener("click", onAppClick);
      byId.detail.addEventListener("click", onDetailClick);
      byId.backBtn.addEventListener("click", () => closeDetail());
      byId.sendReply.addEventListener("click", onSendReply);
      byId.replyText.addEventListener("input", () => {
        const left = 500 - byId.replyText.value.length;
        byId.replyCounter.textContent = left > 99 ? "500" : `${left} left`;
      });
      byId.detail.addEventListener("click", e => {
        if (e.target === byId.detail) closeDetail();
      });

      window.addEventListener("hashchange", () => {
        if (!location.hash.startsWith("#/s/")) {
          closeDetail(false);
          return;
        }
        syncHash();
      });
      window.addEventListener("scroll", onParallaxScroll, { passive: true });
      window.addEventListener("keydown", e => {
        if (e.key === "Escape" && byId.detail.classList.contains("open")) closeDetail();
      });
    }

    init();
  </script>
</body>
</html>
